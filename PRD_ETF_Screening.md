# PRD: ETF 스크리닝 기능

> **프로젝트**: ETF MTS Demo  
> **대상 파일**: `src/pages/DiscoverPage.tsx`, `src/data/mockData.ts`  
> **작성일**: 2026-02-25  
> **우선순위**: Medium-High

---

## 1. 개요 (Overview)

### 배경

현재 `DiscoverPage`는 검색, 테마 필터, 정렬 기능을 제공하지만, 중급자 이상 사용자가 **다중 조건을 조합하여 ETF를 필터링**할 수 있는 스크리닝 기능이 없음.

입문자는 퀵서치(목적별 탐색)로 유도하고, 중급자 이상은 세부 조건 스크리닝으로 유도하는 이중 구조 완성이 목표.

### 목표

- 중급자 이상 사용자가 다중 조건을 조합해 원하는 ETF를 빠르게 발굴할 수 있도록 지원
- 각 지표에 대한 간단한 설명 제공으로 학습 경험 병행
- 기존 비교/상세/관심종목 추가 기능과 자연스럽게 연계

---

## 2. 사용자 스토리

```
중급 투자자로서,
TER이 낮고 AUM이 크고 배당수익률이 높은 국내상장 ETF를 
한 번에 조건을 걸어 찾고 싶다.
그래서 시간 낭비 없이 내 조건에 맞는 ETF 목록을 바로 볼 수 있다.
```

---

## 3. 스코프 (Scope)

### In Scope
- 스크리닝 필터 UI 및 로직 구현
- 필터 결과 리스트 → 기존 ETF 카드 컴포넌트 재사용
- 적용된 필터 수 표시 및 초기화
- 각 지표 설명 툴팁 (바텀시트)
- 기존 관심종목 추가 / 상세 이동 / 비교 기능 연계

### Out of Scope
- 퀵서치(목적별 탐색) 기능 — 별도 기획
- 실시간 API 연동 — 현재 mockData 기반
- 스크리닝 조건 저장/불러오기
- 기술적 분석 항목 (1차 MVP 제외, 2차 고려)

---

## 4. 기능 상세

### 4-1. 진입점

- `DiscoverPage` 상단 필터 영역에 **"스크리닝"** 버튼 추가
- 탭하면 스크리닝 필터 바텀시트(BottomSheet) 또는 풀스크린 모달로 진입
- 적용된 필터가 있을 경우 버튼에 **뱃지 표시** (예: `스크리닝 3`)

```
[ 검색창                    ]
[ 전체 | 시장지수 | 배당 | ... ]   ← 기존 테마 칩
[ 스크리닝 ③ ] [ 정렬 ▼ ]        ← 스크리닝 버튼
```

---

### 4-2. 스크리닝 필터 화면 구조

**레이아웃**: 좌측 카테고리 탭 + 우측 세부 항목 (토스 WTS 구조 참고, 모바일 최적화)

```
┌─────────────────────────────┐
│ ETF 스크리닝          초기화 │  ← 헤더
├──────┬──────────────────────┤
│ 기본 │                      │
│ 비용 │   우측: 선택된 카테고리  │
│ 수익 │   세부 항목 표시        │
│ 배당 │                      │
│ 구성 │                      │
└──────┴──────────────────────┘
│        결과 보기 (N개)        │  ← 하단 고정 CTA
└─────────────────────────────┘
```

---

### 4-3. 필터 항목 정의

#### 📂 기본 정보

| 항목 | 타입 | 옵션 | 데이터 필드 |
|------|------|------|------------|
| 운용사 | 멀티셀렉트 | 미래에셋 / 삼성 / KB / 한화 / 키움 / NH / 신한 | `ETF.issuer` |
| 카테고리 | 멀티셀렉트 | 국내주식 / 해외주식 / 채권 / 원자재 / 부동산 / 혼합 | `ETF.assetClass` |
| 투자지역 | 멀티셀렉트 | 국내 / 미국 / 중국 / 일본 / 인도 / 베트남 / 글로벌 / 기타 | `ETF.marketClass` + 태그 |
| 레버리지 | 단일선택 | 전체 / 일반만 / 레버리지 포함 / 인버스 포함 | `ETF.isLeveraged`, `ETF.isInverse` |
| 환헤지 | 단일선택 | 전체 / 헤지 / 언헤지 | `ETF.isHedged` |
| 상장 기간 | 단일선택 | 전체 / 1년 이상 / 3년 이상 / 5년 이상 | `ETF.listedDate` |

---

#### 📂 비용 & 규모

| 항목 | 타입 | 범위 | 데이터 필드 | 설명 툴팁 |
|------|------|------|------------|-----------|
| 총보수(TER) | 범위 슬라이더 | 0% ~ 1.0% | `ETF.ter` | 연간 운용에 드는 총 비용. 낮을수록 유리 |
| 순자산(AUM) | 범위 슬라이더 | 0 ~ 5조+ | `ETF.aum` | 펀드 규모. 클수록 안정적 |
| 일평균 거래대금 | 범위 슬라이더 | 0 ~ 1000억+ | `ETF.adtv` | 유동성 지표. 높을수록 매매 용이 |
| 괴리율 | 범위 슬라이더 | -2% ~ +2% | `ETF.discrepancy` | NAV 대비 시장가 차이. 0에 가까울수록 좋음 |
| 추적오차 | 범위 슬라이더 | 0% ~ 3% | `ETF.trackingError` | 기초지수 대비 수익률 오차. 낮을수록 좋음 |

---

#### 📂 수익률

| 항목 | 타입 | 범위 | 비고 |
|------|------|------|------|
| 1개월 수익률 | 범위 슬라이더 | -20% ~ +20% | mockData 확장 필요 |
| 3개월 수익률 | 범위 슬라이더 | -30% ~ +30% | mockData 확장 필요 |
| YTD 수익률 | 범위 슬라이더 | -50% ~ +50% | mockData 확장 필요 |
| 1년 수익률 | 범위 슬라이더 | -50% ~ +100% | mockData 확장 필요 |
| 변동성 | 범위 슬라이더 | 0% ~ 50% | `ETF.volatility` |
| 건전성 점수 | 범위 슬라이더 | 0 ~ 100 | `ETF.healthScore` |

> ⚠️ **mockData 확장 필요**: 현재 ETF interface에 기간별 수익률 필드 없음.  
> `returns: { 1m, 3m, ytd, 1y, 3y, 5y }` 필드 추가 필요.

---

#### 📂 배당

| 항목 | 타입 | 범위/옵션 | 데이터 필드 | 설명 툴팁 |
|------|------|----------|------------|-----------|
| 배당수익률 | 범위 슬라이더 | 0% ~ 15% | `ETF.dividendYield` | 연간 분배금 / 현재가 |
| 배당주기 | 멀티셀렉트 | 월배당 / 분기 / 반기 / 연 / 없음 | `ETF.tags` 또는 신규 필드 | - |
| 배당성장률(1Y) | 범위 슬라이더 | -50% ~ +50% | mockData 확장 필요 | 전년 대비 배당 증가율 |

> ⚠️ **mockData 확장 필요**: `dividendFrequency`, `dividendGrowth1y` 필드 추가 필요.

---

#### 📂 구성 & 분산

| 항목 | 타입 | 범위/옵션 | 데이터 필드 | 설명 툴팁 |
|------|------|----------|------------|-----------|
| 구성종목 수 | 범위 슬라이더 | 1 ~ 500+ | mockData 확장 필요 | 보유 종목 수. 많을수록 분산 |
| 상위10 집중도 | 범위 슬라이더 | 0% ~ 100% | mockData 확장 필요 | 상위 10종목 비중 합산 |

> ⚠️ **mockData 확장 필요**: `componentCount`, `top10Concentration` 필드 추가 필요.

---

### 4-4. UI 컴포넌트 상세

#### 범위 슬라이더 (RangeSlider)
```
TER (총보수)                    [?]
|━━━━━━━━●━━━━━━━━━━●━━━━━━━━━|
0%      0.07%    0.30%       1%
```
- 양방향 슬라이더 (min/max 조절)
- 현재 선택값 슬라이더 위에 표시
- `[?]` 아이콘 탭 → 설명 바텀시트

#### 멀티셀렉트 칩
```
[✓ 미래에셋] [삼성] [KB] [한화] [키움]
```
- 선택 시 핑크색 배경 (`#d64f79`)
- 미선택 시 기본 카드 배경

#### 설명 바텀시트
```
┌──────────────────────────┐
│ 총보수 (TER)              │
│ ─────────────────────── │
│ ETF를 운용하는데 드는 연간  │
│ 총 비용입니다. 0.07%라면   │
│ 1년에 1만원당 7원을        │
│ 운용사에 지불합니다.        │
│ 낮을수록 투자자에게 유리.   │
└──────────────────────────┘
```

---

### 4-5. 필터 적용 결과

- 스크리닝 화면 하단 **"결과 보기 (N개)"** 버튼 탭 시 DiscoverPage로 복귀
- ETF 카드 리스트에 스크리닝 결과 표시
- 기존 정렬 기능과 병행 동작 (필터 후 정렬)
- 상단에 **적용된 필터 요약 칩** 표시 (탭 시 해당 필터 바로 제거 가능)

```
[ 스크리닝 ③ ▼ ]  TER ≤0.3% ✕  AUM ≥1000억 ✕  월배당 ✕
```

---

## 5. 데이터 모델 변경사항

### ETF Interface 확장

```typescript
interface ETF {
  // ... 기존 필드 유지 ...

  // 수익률 (신규)
  returns: {
    1m: number    // 1개월 수익률 (%)
    3m: number    // 3개월 수익률 (%)
    ytd: number   // YTD 수익률 (%)
    1y: number    // 1년 수익률 (%)
    3y: number    // 3년 수익률 (%)
    5y: number    // 5년 수익률 (%)
  }

  // 배당 (신규)
  dividendFrequency: 'monthly' | 'quarterly' | 'semiannual' | 'annual' | 'none'
  dividendGrowth1y: number   // 배당성장률 1Y (%)

  // 구성 (신규)
  componentCount: number         // 구성종목 수
  top10Concentration: number     // 상위10 비중 합산 (%)
  
  // 투자지역 (신규 또는 tags 활용)
  investRegion: string   // 'domestic' | 'us' | 'china' | 'japan' | 'india' | 'vietnam' | 'global' | 'other'
}
```

---

## 6. 파일 변경 목록

| 파일 | 변경 내용 |
|------|----------|
| `src/data/mockData.ts` | ETF interface 확장, 65+ 종목 데이터에 신규 필드 추가 |
| `src/pages/DiscoverPage.tsx` | 스크리닝 버튼, 필터 상태 관리, 결과 필터링 로직 추가 |
| `src/components/ScreeningSheet.tsx` | **신규** — 스크리닝 바텀시트 컴포넌트 |
| `src/components/RangeSlider.tsx` | **신규** — 양방향 범위 슬라이더 컴포넌트 |
| `src/components/FilterTooltip.tsx` | **신규** — 지표 설명 바텀시트 컴포넌트 |

---

## 7. 구현 순서 (Claude Code 작업 순서)

```
Step 1. mockData.ts
  → ETF interface에 신규 필드 추가
  → 65개 목업 데이터에 값 채우기

Step 2. RangeSlider.tsx
  → 양방향 슬라이더 컴포넌트 구현
  → min/max props, onChange 콜백

Step 3. FilterTooltip.tsx
  → 지표명 + 설명 텍스트 map 정의
  → 바텀시트 형태로 표시

Step 4. ScreeningSheet.tsx
  → 좌측 카테고리 탭 + 우측 항목 레이아웃
  → 각 카테고리별 필터 항목 렌더링
  → 필터 상태 관리 (로컬 state)
  → 결과 count 실시간 계산
  → "결과 보기" CTA

Step 5. DiscoverPage.tsx
  → 스크리닝 버튼 + 뱃지 추가
  → ScreeningSheet 연결
  → 스크리닝 필터 상태 → ETF 목록 필터링 로직
  → 적용된 필터 요약 칩 표시
```

---

## 8. 디자인 가이드

기존 디자인 시스템 그대로 따름.

| 요소 | 값 |
|------|-----|
| 배경 | `#191322` |
| 카드 | `#1f1a2e` |
| 보더 | `#2d2640` |
| 선택 강조 | `#d64f79` (메인 핑크) |
| 슬라이더 트랙 | `#2d2640` |
| 슬라이더 핸들 | `#d64f79` |
| 비활성 칩 | `bg-[#1f1a2e] border border-[#2d2640]` |
| 활성 칩 | `bg-[#d64f79] text-white` |

---

## 9. 제외 항목 (1차 MVP)

아래 항목은 데이터 복잡도 또는 UX 고려로 1차에서 제외, 2차 검토.

- 기술적 분석 (이동평균선 돌파, RSI, 볼린저밴드)
- 스크리닝 조건 저장/불러오기
- 배당 연속지급 연수
- 배당성장률 3Y / 5Y

---

## 10. 완료 조건 (Definition of Done)

- [ ] 스크리닝 버튼 탭 시 필터 시트 정상 진입
- [ ] 5개 카테고리 탭 전환 정상 동작
- [ ] 각 필터 조건 선택/해제 정상 동작
- [ ] 다중 조건 AND 로직으로 결과 필터링 정확
- [ ] "결과 보기 N개" 실시간 카운트 반영
- [ ] 적용된 필터 칩 표시 및 개별 제거 가능
- [ ] 초기화 버튼으로 전체 필터 리셋
- [ ] 각 지표 [?] 툴팁 정상 표시
- [ ] 결과 리스트에서 상세/비교/관심종목 기능 정상 연계
- [ ] 기존 테마 필터, 정렬 기능과 충돌 없음
